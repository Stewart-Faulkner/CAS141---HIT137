#CAS141 - HIT137 - Assignment 2 - Task 3.1
from collections import Counter
import csv
import re

# File paths
input_file = r'K:\New folder\Assignment 2\output.txt'
output_csv_3_1 = r'K:\New folder\Assignment 2\top_30_words.csv'

# 3.1: Use Python built-in library to count word frequencies
word_counter = Counter()
chunk_size = 1000000

def simple_tokenize(text):
    # Modify regular expression to exclude pure numbers
    return [word for word in re.findall(r'\b[a-zA-Z]+\b', text.lower()) if not word.isdigit()]

with open(input_file, 'r', encoding='utf-8') as f:
    while True:
        chunk = f.read(chunk_size)
        if not chunk:
            break
        words = simple_tokenize(chunk)
        word_counter.update(words)

top_30_words = word_counter.most_common(30)

# Write results to CSV file
with open(output_csv_3_1, 'w', newline='', encoding='utf-8') as f:
    writer = csv.writer(f)
    writer.writerow(['Word', 'Count'])
    writer.writerows(top_30_words)

print(f"Task 3.1: Top 30 most common words (excluding numbers) have been written to {output_csv_3_1}")

# Print results
print("\nTask 3.1: Top 30 most common words (excluding numbers) obtained using Python built-in library:")
for word, count in top_30_words:
    print(f"{word}: {count}")
